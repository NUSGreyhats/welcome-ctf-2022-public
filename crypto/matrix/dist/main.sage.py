

# This file was *autogenerated* from the file main.sage
from sage.all_cmdline import *   # import sage library

_sage_const_4 = Integer(4); _sage_const_5 = Integer(5); _sage_const_256 = Integer(256); _sage_const_0 = Integer(0); _sage_const_32 = Integer(32); _sage_const_16 = Integer(16)
from Crypto.Hash import SHAKE256

n = _sage_const_4 
rounds = _sage_const_5 
mod = _sage_const_256 
A = random_matrix(Zmod(mod), _sage_const_4 , _sage_const_4 )
B = random_matrix(Zmod(mod), _sage_const_4 , _sage_const_4 )

def number_to_matrix(t):
    X = Matrix(Zmod(mod), n, n)
    for i in range(n):
        for j in range(n):
            X[i, j] = t % mod
            t = t // mod
    return X
    
def matrix_to_number(X):
    x = _sage_const_0 
    for i in range(n):
        for j in range(n):
            x = x + int(X[i, j]) * (mod**(i * n + j))
    return x

def hash(x):
    shake = SHAKE256.new()
    shake.update(x)
    t = shake.read(_sage_const_32 ).hex()
    X = number_to_matrix(int(t, _sage_const_16 ))
    for _ in range(rounds):
        X = X * A + B
    return matrix_to_number(X)

def getFlag():
    message = b"https://forms.office.com/r/aDcxg7MK4s"
    return "greyhats{" + hash(message).hex() + "}"

msg = b"If you are interested in joining us as a core team member, please take some time out to fill up the form before 22th Aug (Monday) 2pm."

f = open("output.txt", "w")
f.writelines([hash(msg).hex() + "\n", matrix_to_number(A).hex()])

print(getFlag())

